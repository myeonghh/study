<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="./desktop.css">
	<script src="./desktop.js"></script>
	
	<style>

	</style>
</head>

<body>
	<section class="desktop">

	</section>

	<script>
		//html 요소 추가부분



		let desktop = document.querySelector('.desktop');

		//html 구역 요소 추가부분(틀)
		desktop.innerHTML += '<header class="tab"></header>';
		desktop.innerHTML += '<div class="buttonsArea"></div>';
		desktop.innerHTML += '<div class="main"></div>';
		desktop.innerHTML += '<div class="overlay"></div>';

		// 변수들
		let folderCnt;
		let iconCnt;
		let iconSequence = 1;
		let folderNum = 1;
		let iconNum = 1;

		// DOM 구역 요소들
		let headerTab = document.querySelector('.tab');
		let divButtons = document.querySelector('.buttonsArea');
		let divMain = document.querySelector('.main');
		let divOverlay = document.querySelector('.overlay');


		// 버튼 생성해서 Buttons div에 추가
		let folderBtn = document.createElement('button');
		folderBtn.setAttribute('class', 'topButton');
		folderBtn.innerHTML = '폴더 생성';
		divButtons.appendChild(folderBtn);

		let iconBtn = document.createElement('button');
		iconBtn.setAttribute('class', 'topButton');
		iconBtn.innerHTML = '아이콘 생성';
		divButtons.appendChild(iconBtn);

		let initBtn = document.createElement('button');
		initBtn.setAttribute('class', 'topButton');
		initBtn.innerHTML = '바탕화면 초기화';
		divButtons.appendChild(initBtn);

		let test = new Folder();
		test.create();

		/** -------------------------------------- 함수 모음--------------------------------------*/
		// 폴더 만들어주는 함수!!!!!!!!!
		function createFolder(_folderCnt){
			for(let i = 1; i <= _folderCnt; i++){
				// 폴더 전체구역 div 생성
				let folderArea = document.createElement('span'); //=> 일단 span 태그로 만들었음!
				folderArea.setAttribute('class', 'folderArea');
				divMain.appendChild(folderArea);

				// 폴더 이미지 img 생성
				let folderImg = document.createElement('img');
			 	folderImg.setAttribute('src', 'images/folder.png');
			 	folderImg.setAttribute('alt', `folder${folderNum}`);
			 	folderImg.setAttribute('class', `folderImg folderImg${folderNum}`);
				folderImg.setAttribute('name', folderNum);
			 	folderArea.appendChild(folderImg);

				// 폴더 이름 span 생성
				let folderName = document.createElement('span');
				folderName.setAttribute('class', `folderName folder${folderNum}`);
				folderName.textContent = `folder ${folderNum}`;
				folderArea.appendChild(folderName);

				// 폴더 번호 증가
			 	folderNum++;
			};
		};
	
		// 폴더 더블 클릭시 창 열리는 함수!!!!!!!!
		function openFolder(_folders){
			_folders.forEach(function(folder, index){
				folder.addEventListener('dblclick', function(){
					alert(`${index + 1}폴더 더블클릭`);

					let folderWindow = document.createElement('div');
					folderWindow.setAttribute('class', `folderWindow ${folder.alt}`)
					divOverlay.appendChild(folderWindow);

					folderWindow.innerHTML += `<div class="folderHeader">${folder.alt}<button class="closeBtn">X</button></div>`;
					
					// 폴더 창 nodeList
					let folderWindows = document.querySelectorAll('.folderWindow');
					// 닫기 버튼 nodeList
					let closeBtns = document.querySelectorAll('.closeBtn')
	
					// 닫기버튼 누를시 창 닫는 함수 호출
					closeFolder(closeBtns, folderWindows);
				});
			});
		};
		
		// 폴더 창에서 x버튼 클릭시 창 닫히는 함수!!!!!!!
		function closeFolder(_closeBtns, _folderWindows){		
			for(let i = 0; i < _closeBtns.length; i++){
				_closeBtns[i].addEventListener('click', function(){
					divOverlay.removeChild(_folderWindows[i]);
					console.log('폴더창들 테스트', _folderWindows[i]);
				});				
			};
		};


		// 아이콘 만들어주는 함수!!!!!!!!!!
		function createIcon(_iconCnt){
			for(let i = 1; i <= _iconCnt; i++){
				if(iconSequence > 10){ // => icon10이 넘어가면 다시 icon1 이미지파일 순회
					iconSequence = 1;
				};
				// 아이콘 전체구역 div 생성
				let iconArea = document.createElement('span'); //=> 일단 span 태그로 만들었음!
				iconArea.setAttribute('class', 'iconArea');
				divMain.appendChild(iconArea);

				// 아이콘 이미지 img 생성
				let iconImg = document.createElement('img');
				iconImg.setAttribute('src', `images/icon${iconSequence}.png`);
				iconImg.setAttribute('alt', `icon${iconNum}`);
				iconImg.setAttribute('class', `iconImg icon${iconNum}`);
				iconImg.setAttribute('name', iconNum);
				iconArea.appendChild(iconImg);
				

				// 아이콘 이름 span 생성
				let iconName = document.createElement('span');
				iconName.setAttribute('class', `iconName icon${iconNum}`);
				iconName.textContent = `icon ${iconNum}`;
				iconArea.appendChild(iconName);

				// 아이콘 순서와 아이콘 번호 증가
				iconSequence++;
				iconNum++;
			};
		};


		/** --------------------------------------------------------------------------------------*/
		/**--------------------------------- 버튼 클릭 이벤트-------------------------------------*/
		// 폴더 생성버튼 클릭시 폴더생성 기능추가 
		folderBtn.addEventListener('click', function(){
			folderCnt = Number(prompt('폴더를 몇개 만들까요?'));
			//폴더 만드는 함수 부르기
			createFolder(folderCnt);

			let folders = document.querySelectorAll('.folderImg'); // => 폴더들 IMG 요소
			console.log('이벤트 안', folders);
			// 폴더 열리는 함수 부르기
			openFolder(folders);
			let closeBtn = document.querySelectorAll('.closeBtn')
			console.log('닫기 버튼', closeBtn);
	
		});

		// 아이콘 생성버튼 클릭시 아이콘생성 기능추가
		iconBtn.addEventListener('click', function(){
			iconCnt = Number(prompt('아이콘을 몇개 만들까요?'));
	
			createIcon(iconCnt);
			let icons = document.querySelectorAll('.iconImg'); // => 아이콘들 IMG 요소
		
		});

		// 초기화버튼 초기화 기능 추가
		initBtn.addEventListener('click', function(){
			divMain.innerHTML = '';
			divOverlay.innerHTML = '';
			folderNum = 1;
			iconNum = 1;
		});
		/**----------------------------------------------------------------------------------*/

		// DOM 폴더, 아이콘 이미지 요소들
		let folders = document.querySelectorAll('.folderImg');
		let icons = document.querySelectorAll('.iconImg');








		let myDesktop = new Desktop(
			/* TODO: myDesktop 인스턴스의 생성자의 변수로 무엇이 들어가야 할까요? */
		);
	</script>
</body>

</html>